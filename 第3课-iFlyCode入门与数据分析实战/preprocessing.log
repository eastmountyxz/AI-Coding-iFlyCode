2025-09-21 18:29:33,200 - INFO - 成功加载文件: KDDTrain+.txt
2025-09-21 18:29:33,248 - INFO - 成功加载文件: KDDTest+.txt
2025-09-21 18:29:33,825 - CRITICAL - 预处理过程中发生错误: name 'OneHotEncoder' is not defined
2025-09-21 18:30:40,623 - INFO - 成功加载文件: KDDTrain+.txt
2025-09-21 18:30:40,672 - INFO - 成功加载文件: KDDTest+.txt
2025-09-21 18:30:41,235 - CRITICAL - 预处理过程中发生错误: A given column is not a column of the dataframe
2025-09-21 18:31:55,578 - INFO - 成功加载文件: KDDTrain+.txt
2025-09-21 18:31:55,625 - INFO - 成功加载文件: KDDTest+.txt
2025-09-21 18:31:56,172 - CRITICAL - 预处理过程中发生错误: A given column is not a column of the dataframe
2025-09-21 18:34:20,976 - INFO - 成功加载文件: KDDTrain+.txt  形状: (125973, 43)
2025-09-21 18:34:22,319 - INFO - 成功加载文件: KDDTest+.txt  形状: (22544, 43)
2025-09-21 18:34:22,569 - INFO - Fit/Transform 标准化版本 ...
2025-09-21 18:34:22,788 - INFO - Fit/Transform 归一化版本 ...
2025-09-21 18:34:23,022 - INFO - === 训练集(标准化) ===
2025-09-21 18:34:23,069 - INFO - 样本数: 125973, 特征维度(不含label): 123
2025-09-21 18:34:23,085 - INFO - 标签分布:
                label   label
normal_count  67343.0     NaN
attack_count  58630.0     NaN
normal_ratio      NaN  0.5346
attack_ratio      NaN  0.4654
2025-09-21 18:34:23,100 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration  src_bytes  dst_bytes      land  wrong_fragment    urgent       hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007679  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.717045  -0.354343    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -0.324063           -0.818890               -0.782367               -0.280282                     0.069972                    -0.289103             -0.639532                 -0.624871             -0.224532                 -0.376387    0.216426  normal
1                 0.0                0.0                1.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            1.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007737  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.620982  -0.368110    -0.637209        -0.631929    -0.374362        -0.374432      -1.321428       0.482201           -0.374560        0.734343           -1.035688               -1.161030                2.736852                     2.367737                    -0.289103             -0.639532                 -0.624871             -0.387635                 -0.376387   -1.965556  normal
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      1.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  0.339648  -0.299273     1.602664         1.605104    -0.374362        -0.374432      -1.389669       0.038529           -0.374560        0.734343           -0.809857               -0.938287               -0.174417                    -0.480197                    -0.289103              1.608759                  1.618955             -0.387635                 -0.376387   -0.219970  attack
3                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007723  -0.002891 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023   1.235694        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.690846  -0.313041    -0.189235        -0.184522    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -1.533670            1.258754                1.066401               -0.439078                    -0.383108                     0.066252             -0.572083                 -0.602433             -0.387635                 -0.345084    0.652823  normal
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007728  -0.004814 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023   1.235694        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.472521   0.058678    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.028179        0.734343            1.258754                1.066401               -0.439078                    -0.480197                    -0.289103             -0.639532                 -0.624871             -0.387635                 -0.376387    0.652823  normal
2025-09-21 18:34:23,257 - INFO - === 测试集(标准化) ===
2025-09-21 18:34:23,303 - INFO - 样本数: 22544, 特征维度(不含label): 123
2025-09-21 18:34:23,319 - INFO - 标签分布:
                label   label
attack_count  12833.0     NaN
normal_count   9711.0     NaN
attack_ratio      NaN  0.5692
normal_ratio      NaN  0.4308
2025-09-21 18:34:23,366 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration  src_bytes  dst_bytes      land  wrong_fragment    urgent       hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  1.265346  -0.244204    -0.637209        -0.631929     2.746403         2.715365      -1.412415      -0.016930           -0.374560        0.734343           -0.954389               -1.071933               -0.121485                    -0.480197                    -0.289103             -0.639532                 -0.624871              2.874410                  2.753914    0.652823  attack
1                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  0.453177  -0.368110    -0.637209        -0.631929     2.746403         2.715365      -1.480656      -0.016930           -0.374560        0.734343           -1.035688               -1.161030               -0.121485                    -0.480197                    -0.289103             -0.639532                 -0.624871              2.874410                  2.753914    0.652823  attack
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.109481  -0.005551  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778  -0.368110    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -0.485344           -0.267863                0.197703               -0.227350                     1.493939                    -0.111426             -0.639532                 -0.624871             -0.387635                 -0.376387    0.652823  normal
3                 1.0                0.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            1.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007759  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778   0.513001    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683            3.474118       -1.805831           -0.529826                1.066401               -0.439078                     2.756092                     2.198385             -0.639532                 -0.624871             -0.387635                 -0.376387   -1.965556  attack
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             1.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        1.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.109865  -0.007762  -0.004915 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778  -0.271739    -0.637209        -0.363485     2.746403         1.170466       0.771283      -0.349683            2.511949       -1.543750           -0.267863               -0.470526                0.460769                    -0.383108                    -0.111426             -0.639532                 -0.624871              2.319862                  1.846127   -3.711143  attack
2025-09-21 18:34:23,478 - INFO - === 训练集(归一化) ===
2025-09-21 18:34:23,509 - INFO - 样本数: 125973, 特征维度(不含label): 123
2025-09-21 18:34:23,572 - INFO - 标签分布:
                label   label
normal_count  67343.0     NaN
attack_count  58630.0     NaN
normal_ratio      NaN  0.5346
attack_ratio      NaN  0.4654
2025-09-21 18:34:23,603 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration     src_bytes     dst_bytes  land  wrong_fragment  urgent  hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  3.558064e-07  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.003914   0.003914          0.0              0.0          0.0              0.0           1.00           0.00                0.00        0.588235            0.098039                    0.17                    0.03                         0.17                         0.00                  0.00                      0.00                  0.05                      0.00    0.952381  normal
1                 0.0                0.0                1.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            1.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.057999e-07  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.025440   0.001957          0.0              0.0          0.0              0.0           0.08           0.15                0.00        1.000000            0.003922                    0.00                    0.60                         0.88                         0.00                  0.00                      0.00                  0.00                      0.00    0.714286  normal
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      1.0      0.0      0.0      0.0      0.0      0.0       0.0  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.240705   0.011742          1.0              1.0          0.0              0.0           0.05           0.07                0.00        1.000000            0.101961                    0.10                    0.05                         0.00                         0.00                  1.00                      1.00                  0.00                      0.00    0.904762  attack
3                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.681203e-07  6.223962e-06   0.0             0.0     0.0  0.0                0.0        1.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.009785   0.009785          0.2              0.2          0.0              0.0           1.00           0.00                0.00        0.117647            1.000000                    1.00                    0.00                         0.03                         0.04                  0.03                      0.01                  0.00                      0.01    1.000000  normal
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.442067e-07  3.206260e-07   0.0             0.0     0.0  0.0                0.0        1.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.058708   0.062622          0.0              0.0          0.0              0.0           1.00           0.00                0.09        1.000000            1.000000                    1.00                    0.00                         0.00                         0.00                  0.00                      0.00                  0.00                      0.00    1.000000  normal
2025-09-21 18:34:23,712 - INFO - === 测试集(归一化) ===
2025-09-21 18:34:23,759 - INFO - 样本数: 22544, 特征维度(不含label): 123
2025-09-21 18:34:23,806 - INFO - 标签分布:
                label   label
attack_count  12833.0     NaN
normal_count   9711.0     NaN
attack_ratio      NaN  0.5692
normal_ratio      NaN  0.4308
2025-09-21 18:34:23,837 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration     src_bytes     dst_bytes  land  wrong_fragment  urgent  hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000000  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.448141   0.019569          0.0             0.00          1.0              1.0           0.04           0.06                0.00        1.000000            0.039216                    0.04                    0.06                         0.00                         0.00                   0.0                       0.0                  1.00                      1.00    1.000000  attack
1                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000000  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.266145   0.001957          0.0             0.00          1.0              1.0           0.01           0.06                0.00        1.000000            0.003922                    0.00                    0.06                         0.00                         0.00                   0.0                       0.0                  1.00                      1.00    1.000000  attack
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0  0.000047  9.408217e-06  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.001957          0.0             0.00          0.0              0.0           1.00           0.00                0.00        0.525490            0.337255                    0.61                    0.04                         0.61                         0.02                   0.0                       0.0                  0.00                      0.00    1.000000  normal
3                 1.0                0.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            1.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0  0.000000  1.449313e-08  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.127202          0.0             0.00          0.0              0.0           1.00           0.00                1.00        0.011765            0.223529                    1.00                    0.00                         1.00                         0.28                   0.0                       0.0                  0.00                      0.00    0.714286  attack
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             1.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        1.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000023  0.000000e+00  1.145093e-08   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.015656          0.0             0.12          1.0              0.5           1.00           0.00                0.75        0.113725            0.337255                    0.31                    0.17                         0.03                         0.02                   0.0                       0.0                  0.83                      0.71    0.523810  attack
2025-09-21 18:34:58,054 - INFO - 成功加载文件: KDDTrain+.txt  形状: (125973, 43)
2025-09-21 18:34:59,668 - INFO - 成功加载文件: KDDTest+.txt  形状: (22544, 43)
2025-09-21 18:34:59,975 - INFO - Fit/Transform 标准化版本 ...
2025-09-21 18:35:00,248 - INFO - Fit/Transform 归一化版本 ...
2025-09-21 18:35:00,467 - INFO - === 训练集(标准化) ===
2025-09-21 18:35:00,483 - INFO - 样本数: 125973, 特征维度(不含label): 123
2025-09-21 18:35:00,498 - INFO - 标签分布:
                label   label
normal_count  67343.0     NaN
attack_count  58630.0     NaN
normal_ratio      NaN  0.5346
attack_ratio      NaN  0.4654
2025-09-21 18:35:00,530 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration  src_bytes  dst_bytes      land  wrong_fragment    urgent       hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007679  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.717045  -0.354343    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -0.324063           -0.818890               -0.782367               -0.280282                     0.069972                    -0.289103             -0.639532                 -0.624871             -0.224532                 -0.376387    0.216426  normal
1                 0.0                0.0                1.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            1.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007737  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.620982  -0.368110    -0.637209        -0.631929    -0.374362        -0.374432      -1.321428       0.482201           -0.374560        0.734343           -1.035688               -1.161030                2.736852                     2.367737                    -0.289103             -0.639532                 -0.624871             -0.387635                 -0.376387   -1.965556  normal
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      1.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  0.339648  -0.299273     1.602664         1.605104    -0.374362        -0.374432      -1.389669       0.038529           -0.374560        0.734343           -0.809857               -0.938287               -0.174417                    -0.480197                    -0.289103              1.608759                  1.618955             -0.387635                 -0.376387   -0.219970  attack
3                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007723  -0.002891 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023   1.235694        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.690846  -0.313041    -0.189235        -0.184522    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -1.533670            1.258754                1.066401               -0.439078                    -0.383108                     0.066252             -0.572083                 -0.602433             -0.387635                 -0.345084    0.652823  normal
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007728  -0.004814 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023   1.235694        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.472521   0.058678    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.028179        0.734343            1.258754                1.066401               -0.439078                    -0.480197                    -0.289103             -0.639532                 -0.624871             -0.387635                 -0.376387    0.652823  normal
2025-09-21 18:35:00,650 - INFO - === 测试集(标准化) ===
2025-09-21 18:35:00,697 - INFO - 样本数: 22544, 特征维度(不含label): 123
2025-09-21 18:35:00,753 - INFO - 标签分布:
                label   label
attack_count  12833.0     NaN
normal_count   9711.0     NaN
attack_ratio      NaN  0.5692
normal_ratio      NaN  0.4308
2025-09-21 18:35:00,800 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration  src_bytes  dst_bytes      land  wrong_fragment    urgent       hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  1.265346  -0.244204    -0.637209        -0.631929     2.746403         2.715365      -1.412415      -0.016930           -0.374560        0.734343           -0.954389               -1.071933               -0.121485                    -0.480197                    -0.289103             -0.639532                 -0.624871              2.874410                  2.753914    0.652823  attack
1                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  0.453177  -0.368110    -0.637209        -0.631929     2.746403         2.715365      -1.480656      -0.016930           -0.374560        0.734343           -1.035688               -1.161030               -0.121485                    -0.480197                    -0.289103             -0.639532                 -0.624871              2.874410                  2.753914    0.652823  attack
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.109481  -0.005551  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778  -0.368110    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -0.485344           -0.267863                0.197703               -0.227350                     1.493939                    -0.111426             -0.639532                 -0.624871             -0.387635                 -0.376387    0.652823  normal
3                 1.0                0.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            1.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007759  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778   0.513001    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683            3.474118       -1.805831           -0.529826                1.066401               -0.439078                     2.756092                     2.198385             -0.639532                 -0.624871             -0.387635                 -0.376387   -1.965556  attack
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             1.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        1.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.109865  -0.007762  -0.004915 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778  -0.271739    -0.637209        -0.363485     2.746403         1.170466       0.771283      -0.349683            2.511949       -1.543750           -0.267863               -0.470526                0.460769                    -0.383108                    -0.111426             -0.639532                 -0.624871              2.319862                  1.846127   -3.711143  attack
2025-09-21 18:35:01,048 - INFO - === 训练集(归一化) ===
2025-09-21 18:35:01,093 - INFO - 样本数: 125973, 特征维度(不含label): 123
2025-09-21 18:35:01,156 - INFO - 标签分布:
                label   label
normal_count  67343.0     NaN
attack_count  58630.0     NaN
normal_ratio      NaN  0.5346
attack_ratio      NaN  0.4654
2025-09-21 18:35:01,211 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration     src_bytes     dst_bytes  land  wrong_fragment  urgent  hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  3.558064e-07  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.003914   0.003914          0.0              0.0          0.0              0.0           1.00           0.00                0.00        0.588235            0.098039                    0.17                    0.03                         0.17                         0.00                  0.00                      0.00                  0.05                      0.00    0.952381  normal
1                 0.0                0.0                1.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            1.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.057999e-07  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.025440   0.001957          0.0              0.0          0.0              0.0           0.08           0.15                0.00        1.000000            0.003922                    0.00                    0.60                         0.88                         0.00                  0.00                      0.00                  0.00                      0.00    0.714286  normal
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      1.0      0.0      0.0      0.0      0.0      0.0       0.0  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.240705   0.011742          1.0              1.0          0.0              0.0           0.05           0.07                0.00        1.000000            0.101961                    0.10                    0.05                         0.00                         0.00                  1.00                      1.00                  0.00                      0.00    0.904762  attack
3                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.681203e-07  6.223962e-06   0.0             0.0     0.0  0.0                0.0        1.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.009785   0.009785          0.2              0.2          0.0              0.0           1.00           0.00                0.00        0.117647            1.000000                    1.00                    0.00                         0.03                         0.04                  0.03                      0.01                  0.00                      0.01    1.000000  normal
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.442067e-07  3.206260e-07   0.0             0.0     0.0  0.0                0.0        1.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.058708   0.062622          0.0              0.0          0.0              0.0           1.00           0.00                0.09        1.000000            1.000000                    1.00                    0.00                         0.00                         0.00                  0.00                      0.00                  0.00                      0.00    1.000000  normal
2025-09-21 18:35:01,354 - INFO - === 测试集(归一化) ===
2025-09-21 18:35:01,468 - INFO - 样本数: 22544, 特征维度(不含label): 123
2025-09-21 18:35:01,515 - INFO - 标签分布:
                label   label
attack_count  12833.0     NaN
normal_count   9711.0     NaN
attack_ratio      NaN  0.5692
normal_ratio      NaN  0.4308
2025-09-21 18:35:01,562 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration     src_bytes     dst_bytes  land  wrong_fragment  urgent  hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000000  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.448141   0.019569          0.0             0.00          1.0              1.0           0.04           0.06                0.00        1.000000            0.039216                    0.04                    0.06                         0.00                         0.00                   0.0                       0.0                  1.00                      1.00    1.000000  attack
1                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000000  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.266145   0.001957          0.0             0.00          1.0              1.0           0.01           0.06                0.00        1.000000            0.003922                    0.00                    0.06                         0.00                         0.00                   0.0                       0.0                  1.00                      1.00    1.000000  attack
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0  0.000047  9.408217e-06  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.001957          0.0             0.00          0.0              0.0           1.00           0.00                0.00        0.525490            0.337255                    0.61                    0.04                         0.61                         0.02                   0.0                       0.0                  0.00                      0.00    1.000000  normal
3                 1.0                0.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            1.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0  0.000000  1.449313e-08  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.127202          0.0             0.00          0.0              0.0           1.00           0.00                1.00        0.011765            0.223529                    1.00                    0.00                         1.00                         0.28                   0.0                       0.0                  0.00                      0.00    0.714286  attack
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             1.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        1.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000023  0.000000e+00  1.145093e-08   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.015656          0.0             0.12          1.0              0.5           1.00           0.00                0.75        0.113725            0.337255                    0.31                    0.17                         0.03                         0.02                   0.0                       0.0                  0.83                      0.71    0.523810  attack
2025-09-21 18:35:13,826 - INFO - 预处理完成，已输出标准化与归一化两个版本。
2025-09-21 18:36:28,633 - INFO - 成功加载文件: KDDTrain+.txt  形状: (125973, 43)
2025-09-21 18:36:30,050 - INFO - 成功加载文件: KDDTest+.txt  形状: (22544, 43)
2025-09-21 18:36:30,295 - INFO - Fit/Transform 标准化版本 ...
2025-09-21 18:36:30,529 - INFO - Fit/Transform 归一化版本 ...
2025-09-21 18:36:30,754 - INFO - === 训练集(标准化) ===
2025-09-21 18:36:30,754 - INFO - 样本数: 125973, 特征维度(不含label): 123
2025-09-21 18:36:30,776 - INFO - 标签分布:
                label   label
normal_count  67343.0     NaN
attack_count  58630.0     NaN
normal_ratio      NaN  0.5346
attack_ratio      NaN  0.4654
2025-09-21 18:36:30,803 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration  src_bytes  dst_bytes      land  wrong_fragment    urgent       hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007679  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.717045  -0.354343    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -0.324063           -0.818890               -0.782367               -0.280282                     0.069972                    -0.289103             -0.639532                 -0.624871             -0.224532                 -0.376387    0.216426  normal
1                 0.0                0.0                1.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            1.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007737  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.620982  -0.368110    -0.637209        -0.631929    -0.374362        -0.374432      -1.321428       0.482201           -0.374560        0.734343           -1.035688               -1.161030                2.736852                     2.367737                    -0.289103             -0.639532                 -0.624871             -0.387635                 -0.376387   -1.965556  normal
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      1.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  0.339648  -0.299273     1.602664         1.605104    -0.374362        -0.374432      -1.389669       0.038529           -0.374560        0.734343           -0.809857               -0.938287               -0.174417                    -0.480197                    -0.289103              1.608759                  1.618955             -0.387635                 -0.376387   -0.219970  attack
3                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007723  -0.002891 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023   1.235694        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.690846  -0.313041    -0.189235        -0.184522    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -1.533670            1.258754                1.066401               -0.439078                    -0.383108                     0.066252             -0.572083                 -0.602433             -0.387635                 -0.345084    0.652823  normal
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007728  -0.004814 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023   1.235694        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.472521   0.058678    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.028179        0.734343            1.258754                1.066401               -0.439078                    -0.480197                    -0.289103             -0.639532                 -0.624871             -0.387635                 -0.376387    0.652823  normal
2025-09-21 18:36:30,803 - INFO - === 测试集(标准化) ===
2025-09-21 18:36:30,803 - INFO - 样本数: 22544, 特征维度(不含label): 123
2025-09-21 18:36:30,808 - INFO - 标签分布:
                label   label
attack_count  12833.0     NaN
normal_count   9711.0     NaN
attack_ratio      NaN  0.5692
normal_ratio      NaN  0.4308
2025-09-21 18:36:30,835 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration  src_bytes  dst_bytes      land  wrong_fragment    urgent       hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  1.265346  -0.244204    -0.637209        -0.631929     2.746403         2.715365      -1.412415      -0.016930           -0.374560        0.734343           -0.954389               -1.071933               -0.121485                    -0.480197                    -0.289103             -0.639532                 -0.624871              2.874410                  2.753914    0.652823  attack
1                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.110249  -0.007762  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531  0.453177  -0.368110    -0.637209        -0.631929     2.746403         2.715365      -1.480656      -0.016930           -0.374560        0.734343           -1.035688               -1.161030               -0.121485                    -0.480197                    -0.289103             -0.639532                 -0.624871              2.874410                  2.753914    0.652823  attack
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.109481  -0.005551  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778  -0.368110    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683           -0.374560       -0.485344           -0.267863                0.197703               -0.227350                     1.493939                    -0.111426             -0.639532                 -0.624871             -0.387635                 -0.376387    0.652823  normal
3                 1.0                0.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            1.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0 -0.110249  -0.007759  -0.004919 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778   0.513001    -0.637209        -0.631929    -0.374362        -0.374432       0.771283      -0.349683            3.474118       -1.805831           -0.529826                1.066401               -0.439078                     2.756092                     2.198385             -0.639532                 -0.624871             -0.387635                 -0.376387   -1.965556  attack
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             1.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        1.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0 -0.109865  -0.007762  -0.004915 -0.014089       -0.089486 -0.007736 -0.095076          -0.027023  -0.809262        -0.011664   -0.036652     -0.024437 -0.012385            -0.02618    -0.01861         -0.041221                0.0      -0.002817       -0.097531 -0.725778  -0.271739    -0.637209        -0.363485     2.746403         1.170466       0.771283      -0.349683            2.511949       -1.543750           -0.267863               -0.470526                0.460769                    -0.383108                    -0.111426             -0.639532                 -0.624871              2.319862                  1.846127   -3.711143  attack
2025-09-21 18:36:30,836 - INFO - === 训练集(归一化) ===
2025-09-21 18:36:30,836 - INFO - 样本数: 125973, 特征维度(不含label): 123
2025-09-21 18:36:30,849 - INFO - 标签分布:
                label   label
normal_count  67343.0     NaN
attack_count  58630.0     NaN
normal_ratio      NaN  0.5346
attack_ratio      NaN  0.4654
2025-09-21 18:36:30,874 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration     src_bytes     dst_bytes  land  wrong_fragment  urgent  hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  3.558064e-07  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.003914   0.003914          0.0              0.0          0.0              0.0           1.00           0.00                0.00        0.588235            0.098039                    0.17                    0.03                         0.17                         0.00                  0.00                      0.00                  0.05                      0.00    0.952381  normal
1                 0.0                0.0                1.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            1.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.057999e-07  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.025440   0.001957          0.0              0.0          0.0              0.0           0.08           0.15                0.00        1.000000            0.003922                    0.00                    0.60                         0.88                         0.00                  0.00                      0.00                  0.00                      0.00    0.714286  normal
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      1.0      0.0      0.0      0.0      0.0      0.0       0.0  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.240705   0.011742          1.0              1.0          0.0              0.0           0.05           0.07                0.00        1.000000            0.101961                    0.10                    0.05                         0.00                         0.00                  1.00                      1.00                  0.00                      0.00    0.904762  attack
3                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.681203e-07  6.223962e-06   0.0             0.0     0.0  0.0                0.0        1.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.009785   0.009785          0.2              0.2          0.0              0.0           1.00           0.00                0.00        0.117647            1.000000                    1.00                    0.00                         0.03                         0.04                  0.03                      0.01                  0.00                      0.01    1.000000  normal
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           1.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0       0.0  1.442067e-07  3.206260e-07   0.0             0.0     0.0  0.0                0.0        1.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.058708   0.062622          0.0              0.0          0.0              0.0           1.00           0.00                0.09        1.000000            1.000000                    1.00                    0.00                         0.00                         0.00                  0.00                      0.00                  0.00                      0.00    1.000000  normal
2025-09-21 18:36:30,874 - INFO - === 测试集(归一化) ===
2025-09-21 18:36:30,874 - INFO - 样本数: 22544, 特征维度(不含label): 123
2025-09-21 18:36:30,877 - INFO - 标签分布:
                label   label
attack_count  12833.0     NaN
normal_count   9711.0     NaN
attack_ratio      NaN  0.5692
normal_ratio      NaN  0.4308
2025-09-21 18:36:30,908 - INFO - 前5行:
   protocol_type=icmp  protocol_type=tcp  protocol_type=udp  service=IRC  service=X11  service=Z39_50  service=aol  service=auth  service=bgp  service=courier  service=csnet_ns  service=ctf  service=daytime  service=discard  service=domain  service=domain_u  service=echo  service=eco_i  service=ecr_i  service=efs  service=exec  service=finger  service=ftp  service=ftp_data  service=gopher  service=harvest  service=hostnames  service=http  service=http_2784  service=http_443  service=http_8001  service=imap4  service=iso_tsap  service=klogin  service=kshell  service=ldap  service=link  service=login  service=mtp  service=name  service=netbios_dgm  service=netbios_ns  service=netbios_ssn  service=netstat  service=nnsp  service=nntp  service=ntp_u  service=other  service=pm_dump  service=pop_2  service=pop_3  service=printer  service=private  service=red_i  service=remote_job  service=rje  service=shell  service=smtp  service=sql_net  service=ssh  service=sunrpc  service=supdup  service=systat  service=telnet  service=tftp_u  service=tim_i  service=time  service=urh_i  service=urp_i  service=uucp  service=uucp_path  service=vmnet  service=whois  flag=OTH  flag=REJ  flag=RSTO  flag=RSTOS0  flag=RSTR  flag=S0  flag=S1  flag=S2  flag=S3  flag=SF  flag=SH  duration     src_bytes     dst_bytes  land  wrong_fragment  urgent  hot  num_failed_logins  logged_in  num_compromised  root_shell  su_attempted  num_root  num_file_creations  num_shells  num_access_files  num_outbound_cmds  is_host_login  is_guest_login     count  srv_count  serror_rate  srv_serror_rate  rerror_rate  srv_rerror_rate  same_srv_rate  diff_srv_rate  srv_diff_host_rate  dst_host_count  dst_host_srv_count  dst_host_same_srv_rate  dst_host_diff_srv_rate  dst_host_same_src_port_rate  dst_host_srv_diff_host_rate  dst_host_serror_rate  dst_host_srv_serror_rate  dst_host_rerror_rate  dst_host_srv_rerror_rate  difficulty   label
0                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000000  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.448141   0.019569          0.0             0.00          1.0              1.0           0.04           0.06                0.00        1.000000            0.039216                    0.04                    0.06                         0.00                         0.00                   0.0                       0.0                  1.00                      1.00    1.000000  attack
1                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              1.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       1.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000000  0.000000e+00  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.266145   0.001957          0.0             0.00          1.0              1.0           0.01           0.06                0.00        1.000000            0.003922                    0.00                    0.06                         0.00                         0.00                   0.0                       0.0                  1.00                      1.00    1.000000  attack
2                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               1.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0  0.000047  9.408217e-06  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.001957          0.0             0.00          0.0              0.0           1.00           0.00                0.00        0.525490            0.337255                    0.61                    0.04                         0.61                         0.02                   0.0                       0.0                  0.00                      0.00    1.000000  normal
3                 1.0                0.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            1.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             0.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        0.0          0.0        0.0      0.0      0.0      0.0      0.0      1.0      0.0  0.000000  1.449313e-08  0.000000e+00   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.127202          0.0             0.00          0.0              0.0           1.00           0.00                1.00        0.011765            0.223529                    1.00                    0.00                         1.00                         0.28                   0.0                       0.0                  0.00                      0.00    0.714286  attack
4                 0.0                1.0                0.0          0.0          0.0             0.0          0.0           0.0          0.0              0.0               0.0          0.0              0.0              0.0             0.0               0.0           0.0            0.0            0.0          0.0           0.0             0.0          0.0               0.0             0.0              0.0                0.0           0.0                0.0               0.0                0.0            0.0               0.0             0.0             0.0           0.0           0.0            0.0          0.0           0.0                  0.0                 0.0                  0.0              0.0           0.0           0.0            0.0            0.0              0.0            0.0            0.0              0.0              0.0            0.0                 0.0          0.0            0.0           0.0              0.0          0.0             0.0             0.0             0.0             1.0             0.0            0.0           0.0            0.0            0.0           0.0                0.0            0.0            0.0       0.0       0.0        1.0          0.0        0.0      0.0      0.0      0.0      0.0      0.0      0.0  0.000023  0.000000e+00  1.145093e-08   0.0             0.0     0.0  0.0                0.0        0.0              0.0         0.0           0.0       0.0                 0.0         0.0               0.0                0.0            0.0             0.0  0.001957   0.015656          0.0             0.12          1.0              0.5           1.00           0.00                0.75        0.113725            0.337255                    0.31                    0.17                         0.03                         0.02                   0.0                       0.0                  0.83                      0.71    0.523810  attack
2025-09-21 18:36:38,008 - CRITICAL - 预处理过程中发生错误: [Errno 13] Permission denied: 'processed_train_minmax.csv'
